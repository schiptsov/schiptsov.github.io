<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-11-20 Sun 09:29 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scala3</title>
<meta name="author" content="schiptsov@gmail.com" />
<meta name="generator" content="Org Mode" />
<link rel="preconnect" href="https://fonts.googleapis.com">

<link href="https://fonts.googleapis.com/css?family=Fira Sans" rel="stylesheet">

<link href="https://fonts.googleapis.com/css?family=Fira Code" rel="stylesheet">

<link rel='stylesheet' type='text/css' href='/css/main.css'/>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href=""> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="content" class="content">
<header>
<h1 class="title">Scala3</h1>
</header><p>
When the language specification and the compiler are done, we face a
slow, painful but doable <code>2 -&gt; 3</code> transition, similar to what Python went
through.
</p>

<p>
It is not just matter of accessing old classes, it is an effort to
rewrite parts of important codebases (Spark, Kafka, the Twitter stack)
to use the new standard library and its better abstractions (due to
better typing).
</p>

<p>
I really hope that they at least attempted to unify various <i>in-house
implementations</i> of <i>Streams</i> and <i>Futures</i> and what not. There is no easy or
quick way to <i>evolve stable intermediate forms</i> which is a principal requirement for
an ongoing evolutionary process.
</p>

<p>
The mantra <i>Principle-based is better than rule-based</i> should be the motto
of <code>Scala 3</code>.
</p>

<p>
The sad thing is refusal to just copy fundamental innovations from other
languages
</p>
<ul class="org-ul">
<li><code>where</code> clauses from CLU</li>
<li>proper <i>sum-types</i> and GADTs (fundamental)</li>
<li>type-classes of Haskell (they are just optimal)</li>
<li>modules of Ocaml (it has to be the Java way)</li>
<li>Some Haskell&rsquo;s typing extensions which have proven to be useful.</li>
</ul>

<p>
Anyway, whatever.
</p>
<div id="outline-container-org4dc85e9" class="outline-2">
<h2 id="org4dc85e9">Modern tools</h2>
<div class="outline-text-2" id="text-org4dc85e9">
<ul class="org-ul">
<li><code>cs</code> -  <i>artifact manager</i></li>
<li><code>amm</code> - <i>advanced REPL</i></li>
</ul>

<p>
The Compiler
</p>
<div class="org-src-container">
<pre class="src src-bash">cs setup
</pre>
</div>

<p>
Language-server, linter, formater
</p>
<div class="org-src-container">
<pre class="src src-bash">cs install sbt amm bloop metals scalafix scalafmt
</pre>
</div>

<div class="org-src-container">
<pre class="src src-bash">cs update
</pre>
</div>

<p>
Launch the REPL
</p>
<div class="org-src-container">
<pre class="src src-bash">cs launch ammonite --scala 3.2.1
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scala">$ <span style="color: #81A1C1;">import</span> $ivy.`com.typesafe.akka<span style="color: #81A1C1;">:</span><span style="color: #8FBCBB;">akka</span>-stream_3<span style="color: #81A1C1;">:</span><span style="color: #81A1C1;">2.7.0</span>`
</pre>
</div>
<p>
Basic configuration
</p>

<p>
<code>build.sbt</code>
</p>
<div class="org-src-container">
<pre class="src src-scala"><span style="color: #81A1C1;">val</span> <span style="color: #D8DEE9;">scala3Version</span> <span style="color: #81A1C1;">=</span> <span style="color: #A3BE8C;">"3.2.1"</span>
<span style="color: #81A1C1;">val</span> <span style="color: #D8DEE9;">AkkaVersion</span> <span style="color: #81A1C1;">=</span> <span style="color: #A3BE8C;">"2.7.0"</span>

<span style="color: #81A1C1;">ThisBuild</span> / scalaVersion := scala3Version
<span style="color: #81A1C1;">ThisBuild</span> / scalacOptions ++= <span style="color: #81A1C1;">Seq</span>(<span style="color: #A3BE8C;">"-language:_"</span>, <span style="color: #A3BE8C;">"-deprecation"</span>)

<span style="color: #81A1C1;">lazy</span> <span style="color: #81A1C1;">val</span> <span style="color: #D8DEE9;">root</span> <span style="color: #81A1C1;">=</span> project
  .in(file(<span style="color: #A3BE8C;">"."</span>))
  .settings(

    scalaVersion := scala3Version,

    libraryDependencies += <span style="color: #A3BE8C;">"com.typesafe.akka"</span> %% <span style="color: #A3BE8C;">"akka-stream"</span> % <span style="color: #81A1C1;">AkkaVersion</span>,
  )
</pre>
</div>
<p>
<code>project/plugins.sbt</code>
</p>
<div class="org-src-container">
<pre class="src src-scala">addSbtPlugin(<span style="color: #A3BE8C;">"ch.epfl.scala"</span> % <span style="color: #A3BE8C;">"sbt-bloop"</span> % <span style="color: #A3BE8C;">"1.5.4"</span>)

addSbtPlugin(<span style="color: #A3BE8C;">"ch.epfl.scala"</span> % <span style="color: #A3BE8C;">"sbt-scalafix"</span> % <span style="color: #A3BE8C;">"0.10.4"</span>)
addSbtPlugin(<span style="color: #A3BE8C;">"org.scalameta"</span> % <span style="color: #A3BE8C;">"sbt-scalafmt"</span> % <span style="color: #A3BE8C;">"2.4.6"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-org32d3198" class="outline-2">
<h2 id="org32d3198">Libraries</h2>
<div class="outline-text-2" id="text-org32d3198">
<p>
Most of them are over-&ldquo;engineered&rdquo; and bloated, without any effort of making the
abstractions <i>minimal</i> and &ldquo;just right&rdquo; (optimal). Such &ldquo;natural
selection&rdquo; (of gradual refinement and reduction to a local optimum)
takes decades (like Common Lisp, Ocaml stdlib or Haskell&rsquo;s prelude).
</p>

<p>
Most of corporate code are of <i>low-effort</i>, and mostly &ldquo;copying&rdquo; of <i>imperative</i> implementations from one another.
</p>
<ul class="org-ul">
<li><code>akka</code> - the supposedly done right <i>basic building</i> blocks. Use it.</li>
<li>The <code>Twitter stack</code> (still Scala 2)</li>
<li><code>Kafka</code> - steams</li>
<li><code>Spark</code> - the <i>killer-app</i> (still Scala 2)</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: schiptsov@gmail.com</p>
<p class="email">Email: <a href="mailto:lngnmn2@yahoo.com">lngnmn2@yahoo.com</a></p>
<p class="date">Created: 2022-11-20 Sun 09:29</p>
</div>
</body>
</html>